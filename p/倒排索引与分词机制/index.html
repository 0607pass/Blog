<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content=" Elasticsearch 核心原理：倒排索引与分词机制 倒排索引（Inverted Index）是 Elasticsearch 全文搜索能力的基础，也是搜索引擎普遍采用的一种高效数据结构。通过倒排索引，Elasticsearch 可以快速定位包含某个关键词的文档，极大地提升了搜索性能。\n"><title>倒排索引与分词机制</title><link rel=canonical href=https://0607pass.github.io/Blog/p/%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95%E4%B8%8E%E5%88%86%E8%AF%8D%E6%9C%BA%E5%88%B6/><link rel=stylesheet href=/Blog/scss/style.min.dfff3e85e1b089d3ffb7989c6a0d6c7657148ae86220ad22340ec6971a2e21f4.css><meta property='og:title' content="倒排索引与分词机制"><meta property='og:description' content=" Elasticsearch 核心原理：倒排索引与分词机制 倒排索引（Inverted Index）是 Elasticsearch 全文搜索能力的基础，也是搜索引擎普遍采用的一种高效数据结构。通过倒排索引，Elasticsearch 可以快速定位包含某个关键词的文档，极大地提升了搜索性能。\n"><meta property='og:url' content='https://0607pass.github.io/Blog/p/%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95%E4%B8%8E%E5%88%86%E8%AF%8D%E6%9C%BA%E5%88%B6/'><meta property='og:site_name' content='XFFF 的独立博客'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Elasticsearch'><meta property='article:published_time' content='2026-01-04T21:32:26+08:00'><meta property='article:modified_time' content='2026-01-04T21:32:26+08:00'><meta property='og:image' content='https://0607pass.github.io/Blog/images/postCover/es.png'><meta name=twitter:title content="倒排索引与分词机制"><meta name=twitter:description content=" Elasticsearch 核心原理：倒排索引与分词机制 倒排索引（Inverted Index）是 Elasticsearch 全文搜索能力的基础，也是搜索引擎普遍采用的一种高效数据结构。通过倒排索引，Elasticsearch 可以快速定位包含某个关键词的文档，极大地提升了搜索性能。\n"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://0607pass.github.io/Blog/images/postCover/es.png'></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/Blog/><img src=/Blog/img/avatar_hu_99759e9126fee3e2.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>🚀</span></figure><div class=site-meta><h1 class=site-name><a href=/Blog>XFFF 的独立博客</a></h1><h2 class=site-description>记录独立开发与 AI 学习的点滴</h2></div></header><ol class=menu-social><li><a href=https://github.com/0607pass target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/Blog/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>主页 | Home</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ul><li><a href=#1-什么是倒排索引>1. 什么是倒排索引？</a><ul><li><a href=#简单示例>简单示例</a></li></ul></li><li><a href=#2-倒排索引的构建过程>2. 倒排索引的构建过程</a><ul><li><a href=#步骤一分词tokenization>步骤一：分词（Tokenization）</a></li><li><a href=#步骤二归一化normalization>步骤二：归一化（Normalization）</a></li><li><a href=#步骤三创建并存储索引>步骤三：创建并存储索引</a></li></ul></li><li><a href=#3-用户发起搜索的过程>3. 用户发起搜索的过程</a></li><li><a href=#4-elasticsearch-分词器analyzer>4. Elasticsearch 分词器（Analyzer）</a><ul><li><a href=#分词器的三个组成部分>分词器的三个组成部分</a></li><li><a href=#常见内置分词器对比>常见内置分词器对比</a></li><li><a href=#验证分词效果>验证分词效果</a></li></ul></li></ul><ul><li><a href=#1-什么是-ik-中文分词器>1. 什么是 IK 中文分词器？</a><ul><li><a href=#主要特点>主要特点</a></li></ul></li><li><a href=#2-安装-ik-插件docker-环境>2. 安装 IK 插件（Docker 环境）</a><ul><li><a href=#第一步进入容器内部>第一步：进入容器内部</a></li><li><a href=#第二步执行安装命令>第二步：执行安装命令</a></li><li><a href=#第三步备份插件文件可选但推荐>第三步：备份插件文件（可选但推荐）</a></li><li><a href=#第四步重启服务>第四步：重启服务</a></li></ul></li><li><a href=#3-ik-分词模式对比>3. IK 分词模式对比</a></li><li><a href=#4-效果演示>4. 效果演示</a><ul><li><a href=#场景一智能分词ik_smart>场景一：智能分词（ik_smart）</a></li><li><a href=#场景二默认分词器对比standard>场景二：默认分词器对比（standard）</a></li><li><a href=#场景三细粒度分词ik_max_word>场景三：细粒度分词（ik_max_word）</a></li></ul></li></ul></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/Blog/p/%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95%E4%B8%8E%E5%88%86%E8%AF%8D%E6%9C%BA%E5%88%B6/><img src=/Blog/images/postCover/es.png loading=lazy alt="Featured image of post 倒排索引与分词机制"></a></div><div class=article-details><header class=article-category><a href=/Blog/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/>中间件</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/Blog/p/%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95%E4%B8%8E%E5%88%86%E8%AF%8D%E6%9C%BA%E5%88%B6/>倒排索引与分词机制</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2026-01-04T21:32:26+08:00>2026-01-04</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 5 分钟</time></div></footer></div></header><section class=article-content><hr><h1 id=elasticsearch-核心原理倒排索引与分词机制>Elasticsearch 核心原理：倒排索引与分词机制</h1><p>倒排索引（Inverted Index）是 Elasticsearch 全文搜索能力的基础，也是搜索引擎普遍采用的一种高效数据结构。通过倒排索引，Elasticsearch 可以快速定位包含某个关键词的文档，极大地提升了搜索性能。</p><h2 id=1-什么是倒排索引>1. 什么是倒排索引？</h2><p><strong>倒排索引</strong>是从<strong>关键词到文档</strong>的映射。</p><ul><li><strong>正排索引（Forward Index）：</strong> 存储的是“文档 ID 内容”，类似于书的目录。</li><li><strong>倒排索引（Inverted Index）：</strong> 存储的是“关键词 文档 ID 列表”，类似于书末尾的索引关键词表。</li></ul><h3 id=简单示例>简单示例</h3><p>假设有以下三个文档：</p><ul><li><strong>文档 1:</strong> Elasticsearch 是分布式引擎</li><li><strong>文档 2:</strong> 分布式系统的核心是搜索</li><li><strong>文档 3:</strong> 搜索引擎的未来是智能化</li></ul><p><strong>生成的倒排索引如下表：</strong></p><div class=table-wrapper><table><thead><tr><th>关键词</th><th>文档 ID 列表</th></tr></thead><tbody><tr><td>elasticsearch</td><td>1</td></tr><tr><td>分布式</td><td>1, 2</td></tr><tr><td>系统</td><td>2</td></tr><tr><td>核心</td><td>2</td></tr><tr><td>搜索</td><td>2, 3</td></tr><tr><td>引擎</td><td>1, 3</td></tr><tr><td>智能化</td><td>3</td></tr></tbody></table></div><blockquote><p><strong>效果：</strong> 当用户搜索“引擎”时，Elasticsearch 无需扫描所有文档，直接通过索引即可锁定文档 1 和 3。</p></blockquote><hr><h2 id=2-倒排索引的构建过程>2. 倒排索引的构建过程</h2><p>Elasticsearch 构建倒排索引主要分为以下三个步骤：</p><h3 id=步骤一分词tokenization>步骤一：分词（Tokenization）</h3><p>将文本内容拆分为独立的单词或短语。</p><ul><li><strong>原语句：</strong> <code>Elasticsearch 是分布式引擎</code></li><li><strong>分词结果：</strong> <code>[Elasticsearch, 是, 分布式, 引擎]</code></li></ul><h3 id=步骤二归一化normalization>步骤二：归一化（Normalization）</h3><p>对分词结果进行标准化处理，提高匹配成功率：</p><ul><li><strong>转小写：</strong> <code>Elasticsearch</code> <code>elasticsearch</code>。</li><li><strong>去除停用词：</strong> 删除 “的”、“是” 等对搜索贡献较小的词。</li><li><strong>词干提取：</strong> 将词汇归为基本形式（如 <code>running</code> <code>run</code>）。</li></ul><h3 id=步骤三创建并存储索引>步骤三：创建并存储索引</h3><p>根据处理后的词项建立映射关系，最终形成可供查询的结构：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;elasticsearch&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;分布式&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;引擎&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;搜索&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=3-用户发起搜索的过程>3. 用户发起搜索的过程</h2><p>当用户执行查询（如搜索“分布式搜索”）时，系统遵循以下逻辑：</p><ol><li><strong>解析查询条件：</strong> 将搜索词解析为分词结果 <code>[分布式, 搜索]</code>。</li><li><strong>查找倒排索引：</strong></li></ol><ul><li><code>分布式</code> <code>[1, 2]</code></li><li><code>搜索</code> <code>[2, 3]</code></li></ul><ol start=3><li><strong>合并结果：</strong></li></ol><ul><li><strong>AND 查询（交集）：</strong> 返回 <code>[2]</code>。</li><li><strong>OR 查询（并集）：</strong> 返回 <code>[1, 2, 3]</code>（默认行为）。</li></ul><ol start=4><li><strong>相关性排序：</strong> 根据相关性评分（如 TF-IDF 或 BM25）对结果排序并返回。</li></ol><hr><h2 id=4-elasticsearch-分词器analyzer>4. Elasticsearch 分词器（Analyzer）</h2><p>分词器是处理文本的核心组件，决定了数据如何被“切分”和“清洗”。</p><h3 id=分词器的三个组成部分>分词器的三个组成部分</h3><ol><li><strong>字符过滤（Character Filters）：</strong> 预处理，如去除 HTML 标签。</li><li><strong>分词（Tokenizer）：</strong> 核心切分逻辑，按空格或符号拆分。</li><li><strong>词项过滤（Token Filters）：</strong> 后处理，如转小写、去停用词。</li></ol><h3 id=常见内置分词器对比>常见内置分词器对比</h3><div class=table-wrapper><table><thead><tr><th>分词器类型</th><th>特点说明</th><th>示例输入</th><th>分词结果</th></tr></thead><tbody><tr><td><strong>Standard</strong></td><td>默认分词器，按标准语法切分并转小写</td><td><code>Elasticsearch is powerful.</code></td><td><code>["elasticsearch", "is", "powerful"]</code></td></tr><tr><td><strong>Simple</strong></td><td>仅按非字母字符切分，过滤数字和符号</td><td><code>Text123 data!</code></td><td><code>["text", "data"]</code></td></tr><tr><td><strong>Whitespace</strong></td><td>仅以空格分词，不处理大小写</td><td><code>The quick</code></td><td><code>["The", "quick"]</code></td></tr><tr><td><strong>Keyword</strong></td><td>不分词，将整条输入作为一个词项</td><td><code>user_id:123</code></td><td><code>["user_id:123"]</code></td></tr><tr><td><strong>Stop</strong></td><td>在 Standard 基础上移除停用词</td><td><code>The quick</code></td><td><code>["quick"]</code></td></tr></tbody></table></div><h3 id=验证分词效果>验证分词效果</h3><p>在 Elasticsearch Dev Tools 中，可以使用 <code>_analyze</code> API 进行测试：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>POST /_analyze
</span></span></span><span class=line><span class=cl><span class=err>{
</span></span></span><span class=line><span class=cl><span class=err>  &#34;analyzer&#34;: &#34;standard&#34;,
</span></span></span><span class=line><span class=cl><span class=err>  &#34;text&#34;: &#34;Elasticsearch is powerful.&#34;
</span></span></span><span class=line><span class=cl><span class=err>}
</span></span></span></code></pre></td></tr></table></div></div><p>这份关于 <strong>IK 中文分词器</strong> 的详细教程已整理为 Markdown 格式。我已按照您的要求，将示例内容替换为更具通用性的技术文本（去除了原有的特定名称）。</p><hr><h1 id=elasticsearch-ik-中文分词器详解>Elasticsearch ：IK 中文分词器详解</h1><p>在处理英文文本时，由于词与词之间有空格，按空格分词非常方便。但中文句子是连续的，默认的 <code>standard</code> 分词器只能简单地“一字一分”，无法识别中文词汇。</p><p><strong>IK 分词器（IK Analyzer）</strong> 是一个专门为中文设计的分词插件，支持细粒度分词和智能分词，是目前 Elasticsearch 中文搜索场景下的首选方案。</p><h2 id=1-什么是-ik-中文分词器>1. 什么是 IK 中文分词器？</h2><p>IK 分词器是基于 Apache Lucene 的中文分词插件，专为 Elasticsearch 提供支持。它能根据内置词典和语义规则，将中文句子拆分为具备实际意义的词条。</p><h3 id=主要特点>主要特点</h3><ul><li><strong>两种模式：</strong> 支持细粒度分词（<code>ik_max_word</code>）和智能分词（<code>ik_smart</code>）。</li><li><strong>扩展性：</strong> 支持用户自定义扩展词典，添加行业术语或网络流行词。</li><li><strong>动态调整：</strong> 支持热更新词典，无需重启服务即可更新分词规则。</li></ul><hr><h2 id=2-安装-ik-插件docker-环境>2. 安装 IK 插件（Docker 环境）</h2><h3 id=第一步进入容器内部>第一步：进入容器内部</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker <span class=nb>exec</span> -it es7 /bin/sh
</span></span></code></pre></td></tr></table></div></div><p>进入后通过 <code>ls</code> 命令可以确认当前处于 Elasticsearch 的根目录。</p><h3 id=第二步执行安装命令>第二步：执行安装命令</h3><p>运行以下命令下载并安装 IK 插件（请根据您的 ES 版本调整版本号）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bin/elasticsearch-plugin install https://get.infini.cloud/elasticsearch/analysis-ik/7.3.0
</span></span></code></pre></td></tr></table></div></div><p>安装过程中提示确认时，输入 <code>y</code> 并回车。</p><h3 id=第三步备份插件文件可选但推荐>第三步：备份插件文件（可选但推荐）</h3><p>退出容器后，将插件及配置文件复制到宿主机，防止容器删除后数据丢失：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>exit</span>
</span></span><span class=line><span class=cl><span class=c1># 复制到宿主机对应目录（示例路径，请根据实际情况修改）</span>
</span></span><span class=line><span class=cl>docker cp es7:/usr/share/elasticsearch/plugins/analysis-ik /your/path/plugins
</span></span><span class=line><span class=cl>docker cp es7:/usr/share/elasticsearch/config/analysis-ik /your/path/config
</span></span></code></pre></td></tr></table></div></div><h3 id=第四步重启服务>第四步：重启服务</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker restart es7
</span></span></code></pre></td></tr></table></div></div><p><strong>验证：</strong> 查看容器日志，若看到 <code>loaded plugin [analysis-ik]</code> 字样，说明加载成功。</p><hr><h2 id=3-ik-分词模式对比>3. IK 分词模式对比</h2><p>IK 分词器提供了两种核心分词模式：</p><div class=table-wrapper><table><thead><tr><th>模式</th><th>名称</th><th>分词策略</th><th>适用场景</th></tr></thead><tbody><tr><td><strong><code>ik_smart</code></strong></td><td>智能分词</td><td>粗粒度切分，追求语义完整性</td><td><strong>搜索查询时</strong>使用</td></tr><tr><td><strong><code>ik_max_word</code></strong></td><td>细粒度分词</td><td>穷举所有可能的组合，词量大</td><td><strong>建立索引时</strong>使用</td></tr></tbody></table></div><hr><h2 id=4-效果演示>4. 效果演示</h2><h3 id=场景一智能分词ik_smart>场景一：智能分词（ik_smart）</h3><p>我们将测试一段技术描述文字。</p><p><strong>请求：</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>POST /_analyze
</span></span></span><span class=line><span class=cl><span class=err>{
</span></span></span><span class=line><span class=cl><span class=err>  &#34;analyzer&#34;: &#34;ik_smart&#34;,
</span></span></span><span class=line><span class=cl><span class=err>  &#34;text&#34;: &#34;分布式系统架构如何设计？&#34;
</span></span></span><span class=line><span class=cl><span class=err>}
</span></span></span></code></pre></td></tr></table></div></div><p><strong>预期分词结果：</strong></p><blockquote><p><code>分布式</code> / <code>系统</code> / <code>架构</code> / <code>如何</code> / <code>设计</code></p></blockquote><hr><h3 id=场景二默认分词器对比standard>场景二：默认分词器对比（standard）</h3><p>对比 ES 默认分词器对中文的处理方式。</p><p><strong>请求：</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>POST /_analyze
</span></span></span><span class=line><span class=cl><span class=err>{
</span></span></span><span class=line><span class=cl><span class=err>  &#34;analyzer&#34;: &#34;standard&#34;,
</span></span></span><span class=line><span class=cl><span class=err>  &#34;text&#34;: &#34;分布式系统架构如何设计？&#34;
</span></span></span><span class=line><span class=cl><span class=err>}
</span></span></span></code></pre></td></tr></table></div></div><p><strong>预期分词结果（逐字拆分）：</strong></p><blockquote><p><code>分</code> / <code>布</code> / <code>式</code> / <code>系</code> / <code>统</code> / <code>架</code> / <code>构</code> / <code>如</code> / <code>何</code> / <code>设</code> / <code>计</code></p></blockquote><hr><h3 id=场景三细粒度分词ik_max_word>场景三：细粒度分词（ik_max_word）</h3><p>对于复杂的专有名词，<code>ik_max_word</code> 会进行穷举。</p><p><strong>请求：</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>POST /_analyze
</span></span></span><span class=line><span class=cl><span class=err>{
</span></span></span><span class=line><span class=cl><span class=err>  &#34;analyzer&#34;: &#34;ik_max_word&#34;,
</span></span></span><span class=line><span class=cl><span class=err>  &#34;text&#34;: &#34;北京互联网科技公司&#34;
</span></span></span><span class=line><span class=cl><span class=err>}
</span></span></span></code></pre></td></tr></table></div></div><p><strong>预期分词结果：</strong></p><blockquote><p><code>北京</code> / <code>互联网</code> / <code>互联</code> / <code>网</code> / <code>科技公司</code> / <code>科技</code> / <code>公司</code></p></blockquote><hr><p>IK 分词器通过 <code>ik_smart</code> 保证了搜索的<strong>准确性</strong>，通过 <code>ik_max_word</code> 保证了索引的<strong>覆盖面</strong>。在实际业务中，通常采取“索引时细粒度，搜索时智能化”的策略，以达到最佳的搜索体验。</p><hr></section><footer class=article-footer><section class=article-tags><a href=/Blog/tags/elasticsearch/>Elasticsearch</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>CC BY-NC 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/Blog/p/elasticsearch-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/><div class=article-image><img src=/Blog/images/postCover/es.png loading=lazy data-key data-hash=/Blog/images/postCover/es.png></div><div class=article-details><h2 class=article-title>Elasticsearch 数据类型</h2></div></a></article><article class=has-image><a href=/Blog/p/elasticsearch-%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5/><div class=article-image><img src=/Blog/images/postCover/es.png loading=lazy data-key data-hash=/Blog/images/postCover/es.png></div><div class=article-details><h2 class=article-title>Elasticsearch 核心概念</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2024 -
2026 © {year} XFFF</section><section class=powerby>用 Hugo + GitHub Pages 驱动<br>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.32.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/Blog/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><style>#TableOfContents>ul,ol{ul, ol { display: none; } .open { display: block; }}#backTopBtn{display:none;position:fixed;bottom:30px;right:30px;z-index:99;cursor:pointer;width:30px;height:30px;background:var(--accent-color);border-radius:50%;background-size:contain;background-repeat:no-repeat}#backTopBtn:before{content:"↑";color:var(--accent-color-text);display:flex;align-items:center;justify-content:center;width:100%;height:100%;font-size:20px}.highlight{max-height:400px;overflow:hidden;position:relative}.code-show{max-height:none!important}.code-more-box{width:100%;padding-top:78px;background-image:-webkit-gradient(linear,left top,left bottom,from(rgba(255,255,255,0)),to(#fff));position:absolute;left:0;right:0;bottom:0;z-index:1}[data-scheme=dark] .code-more-box{background-image:-webkit-gradient(linear,left top,left bottom,from(rgba(66,66,66,0)),to(#424242))}.code-more-btn{display:block;margin:auto;width:44px;height:22px;background:#f0f0f5;border-top-left-radius:8px;border-top-right-radius:8px;padding-top:6px;cursor:pointer}[data-scheme=dark] .code-more-btn{background:#545454}.code-more-img{cursor:pointer!important;display:block;margin:auto;width:22px;height:16px}body{background:url(https://0607pass.github.io/Blog/background/bg.jpg)no-repeat 50% 0;background-size:cover;background-attachment:fixed}#particles-js{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;pointer-events:none}#aplayer{z-index:9999}.aplayer{z-index:9999!important}.article-content p:has(>img:only-child){line-height:0!important;margin-bottom:20px!important}.article-content figure.gallery-image{margin:0;padding:0;display:block}.pswp{transition:none!important}.article-content a[href*=".png"],.article-content a[href*=".jpg"],.article-content a[href*=".jpeg"],.article-content a[href*=".gif"]{display:inline-block;line-height:0}</style><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css><div id=aplayer></div><script src=https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js></script><script src=https://cdn.jsdelivr.net/npm/pjax/pjax.min.js></script><script src=/Blog/js/gallery-fix.js></script><script>const BG_IMAGE_URL="https://0607pass.github.io/Blog/background/bg.jpg",SAKURA_URL="https://0607pass.github.io/Blog/background/sakura.js",PARTICLES_SCRIPT_URL="https://0607pass.github.io/Blog/background/particles.min.js",PARTICLES_CONFIG_URL="https://0607pass.github.io/Blog/background/particlesjs-config.json";function initTocHide(){let e=document.querySelector(".widget--toc");if(!e)return;window.addEventListener("scroll",function(){let n=document.querySelectorAll(".open");n.length>0&&n.forEach(e=>e.classList.remove("open"));let t=document.querySelector(".active-class");if(!t)return;t.children.length>1&&t.children[1].classList.add("open");let e=t.parentElement;do e.classList.add("open"),e=e.parentElement.parentElement;while(e!==0[0]&&(e.localName==="ul"||e.localName==="ol"))})}function initScrollTop(){let t=document.querySelector(".right-sidebar");if(!t)return;let e=document.createElement("div");e.id="backTopBtn",e.onclick=backToTop,t.appendChild(e),window.onscroll=function(){document.body.scrollTop>20||document.documentElement.scrollTop>20?e.style.display="block":e.style.display="none"}}function backToTop(){window.scrollTo({top:0,behavior:"smooth"})}function initCodeMoreBox(){let e=document.querySelectorAll(".highlight");if(!e)return;e.forEach(e=>{if(e.scrollHeight<=e.clientHeight)return;let n=document.createElement("div");n.classList.add("code-more-box");let t=document.createElement("span");t.classList.add("code-more-btn"),t.addEventListener("click",()=>{e.classList.add("code-show"),n.style.display="none",window.dispatchEvent(new Event("resize"))}),t.textContent="展开",t.style.padding="4px 8px",t.style.fontSize="12px",n.appendChild(t),e.appendChild(n)})}function initBackground(){if(BG_IMAGE_URL&&document.body&&(document.body.style.backgroundImage=`url(${BG_IMAGE_URL})`,document.body.style.backgroundRepeat="no-repeat",document.body.style.backgroundPosition="center top",document.body.style.backgroundSize="cover",document.body.style.backgroundAttachment="fixed"),SAKURA_URL){if(window.__sakuraInstance&&typeof window.__sakuraInstance.destroy=="function")try{window.__sakuraInstance.destroy()}catch{}const t=document.querySelector('script[src="'+SAKURA_URL+'"]');t&&t.remove();const e=document.createElement("script");e.src=SAKURA_URL,e.onload=()=>{window.__sakuraInstance=!0},document.body.appendChild(e)}if(PARTICLES_SCRIPT_URL&&PARTICLES_CONFIG_URL){let e=document.getElementById("particles-js");if(e||(e=document.createElement("div"),e.id="particles-js",document.body.prepend(e)),window.pJSDom&&window.pJSDom.length&&(window.pJSDom.forEach(e=>{e.pJS&&e.pJS.fn&&e.pJS.fn.vendors&&e.pJS.fn.vendors.destroypJS&&e.pJS.fn.vendors.destroypJS()}),window.pJSDom=[]),window.__particlesScriptLoaded)window.particlesJS&&setTimeout(()=>{window.particlesJS&&document.getElementById("particles-js")&&window.particlesJS.load("particles-js",PARTICLES_CONFIG_URL)},100);else{window.__particlesScriptLoaded=!0;const e=document.createElement("script");e.src=PARTICLES_SCRIPT_URL,e.onload=()=>{window.particlesJS&&window.particlesJS.load("particles-js",PARTICLES_CONFIG_URL)},document.body.appendChild(e)}}}function initAll(){initTocHide(),initScrollTop(),initCodeMoreBox(),initBackground(),window.Stack&&typeof window.Stack.init=="function"&&window.Stack.init(),window.applyGalleryFix&&window.applyGalleryFix()}initAll(),function(){if(window.__aplayerInstance)return;const a=document.getElementById("aplayer");if(!a||!window.APlayer)return;const c="https://0607pass.github.io/Blog/",n=e=>`${c}mp3/${encodeURIComponent(e)}`,s=[{name:"可惜没如果",artist:"林俊杰",url:n("林俊杰-可惜没如果.mp3"),cover:"https://picsum.photos/200/200?random=13"},{name:"查无此字",artist:"林奕匡",url:n("查无此字-林奕匡#eQSOo.mp3"),cover:"https://picsum.photos/200/200?random=11"},{name:"我怀念的",artist:"孙燕姿",url:n("孙燕姿-我怀念的.mp3"),cover:"https://picsum.photos/200/200?random=12"},{name:"老男孩",artist:"筷子兄弟",url:n("筷子兄弟-老男孩.mp3"),cover:"https://picsum.photos/200/200?random=196"},{name:"出现又离开（Live）",artist:"梁博",url:n("出现又离开.mp3"),cover:"https://picsum.photos/200/200?random=19"}];if(!s.length)return;const r="aplayer-play-info";let o=null;try{const e=localStorage.getItem(r);o=e?JSON.parse(e):null}catch(e){console.error("APlayer restore parse error",e)}const t=new APlayer({container:a,fixed:!0,autoplay:!1,lrcType:0,theme:"#409EFF",audio:s});window.__aplayerInstance=t;const i=()=>{if(!t.audio)return;localStorage.setItem(r,JSON.stringify({index:t.list.index||0,currentTime:t.audio.currentTime||0,paused:t.audio.paused}))};if(window.addEventListener("beforeunload",i),window.addEventListener("pagehide",i),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&i()}),o){const{index:e=0,currentTime:n=0,paused:i=!0}=o;t.on("canplay",function o(){t.off("canplay",o);try{e>=0&&e<s.length&&t.list.switch(e),t.seek(n||0),i===!1?t.play():t.pause()}catch(e){console.error("APlayer restore failed",e)}})}}(),function(){if(window.__pjaxInstance||!window.Pjax)return;if(window.Pjax&&window.Pjax.prototype){const e=window.Pjax.prototype.handleResponse;window.Pjax.prototype.handleResponse=function(t,n,s,o){try{if(n&&n.responseText&&n.responseText.match("<html")){const t=new DOMParser,s=t.parseFromString(n.responseText,"text/html"),e=s.body.className;e&&document.body.className!==e&&(document.body.className=e)}}catch(e){console.warn("PJAX handleResponse error:",e)}return e.call(this,t,n,s,o)}}window.__pjaxInstance=new Pjax({selectors:["title",".main-container"],cacheBust:!1}),document.addEventListener("pjax:complete",()=>{setTimeout(()=>{initTocHide(),initScrollTop(),initCodeMoreBox(),initBackground(),window.Stack&&typeof window.Stack.init=="function"&&window.Stack.init()},50)}),document.addEventListener("pjax:send",()=>{const e=document.getElementById("particles-js");e&&(e.style.display="block"),BG_IMAGE_URL&&document.body&&(document.body.style.backgroundImage=`url(${BG_IMAGE_URL})`,document.body.style.backgroundRepeat="no-repeat",document.body.style.backgroundPosition="center top",document.body.style.backgroundSize="cover",document.body.style.backgroundAttachment="fixed")})}()</script></body></html>